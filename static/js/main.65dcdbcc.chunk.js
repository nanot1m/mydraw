(this.webpackJsonpmydraw=this.webpackJsonpmydraw||[]).push([[0],[,,,,,,function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r=n(2),a=n(0),c=new WeakMap;function i(t){var e=Object(a.a)(Object(a.a)({},t),{},{__TYPE__:"DrawElementConfig",getBoundingBox:function(e){return c.has(e)||c.set(e,t.getBoundingBox(e)),c.get(e)},containsPoint:function(n,a){var c=e.getBoundingBox(n),i=Object(r.a)(a,2),o=i[0],u=i[1];return!!(c.x-10<=o&&c.x+c.width+10>=o&&c.y-10<=u&&c.y+c.height+10>=u)&&t.containsPoint(n,a)}});return e}function o(t){return"object"===typeof t&&null!=t&&"DrawElementConfig"===Reflect.get(t,"__TYPE__")}},,,,,,,,,,,,,function(t,e,n){},function(t,e,n){},function(t,e,n){var r={"./Draw.element.ts":27,"./Line.element.ts":22,"./Rect.element.ts":23};function a(t){var e=c(t);return n(e)}function c(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}a.keys=function(){return Object.keys(r)},a.resolve=c,t.exports=a,a.id=21},function(t,e,n){"use strict";n.r(e),n.d(e,"config",(function(){return i}));var r=n(0),a=n(2),c=n(6),i=Object(c.a)({name:"Line",draw:function(t,e){e.lineWidth=4,e.strokeStyle=t.color,e.beginPath(),e.moveTo(t.x0,t.y0),e.lineTo(t.x1,t.y1),e.stroke()},onCreate:function(t,e){return{color:"#000000",x0:t,y0:e,x1:t,y1:e}},onDrawing:function(t,e,n){return{x1:n.x1+t,y1:n.y1+e}},getBoundingBox:function(t){return{x:Math.min(t.x0,t.x1),y:Math.min(t.y0,t.y1),width:Math.abs(t.x0-t.x1),height:Math.abs(t.y0-t.y1)}},containsPoint:function(t,e){var n=Object(a.a)(e,2),r=n[0],c=n[1];return Math.min(t.x0,t.x1)<=r&&Math.max(t.x0,t.x1)>=r&&Math.min(t.y0,t.y1)<=c&&Math.max(t.y0,t.y1)>=c},shift:function(t,e){var n=Object(a.a)(e,2),c=n[0],i=n[1];return Object(r.a)(Object(r.a)({},t),{},{x0:t.x0+c,y0:t.y0+i,x1:t.x1+c,y1:t.y1+i})}})},function(t,e,n){"use strict";n.r(e),n.d(e,"config",(function(){return i}));var r=n(0),a=n(2),c=n(6),i=Object(c.a)({name:"Rect",draw:function(t,e){e.lineWidth=4,e.strokeStyle=t.strokeColor,e.fillStyle=t.backgroundColor,e.beginPath(),e.rect(t.x0,t.y0,t.x1-t.x0,t.y1-t.y0),e.fill(),e.stroke()},onCreate:function(t,e){return{backgroundColor:"transparent",strokeColor:"black",x0:t,y0:e,x1:t,y1:e}},onDrawing:function(t,e,n){return{x1:n.x1+t,y1:n.y1+e}},getBoundingBox:function(t){return{x:Math.min(t.x0,t.x1),y:Math.min(t.y0,t.y1),width:Math.abs(t.x1-t.x0),height:Math.abs(t.y1-t.y0)}},containsPoint:function(t,e){var n=Object(a.a)(e,2),r=n[0],c=n[1];return Math.min(t.x0,t.x1)-4<=r&&Math.max(t.x0,t.x1)+4>=r&&Math.min(t.y0,t.y1)-4<=c&&Math.max(t.y0,t.y1)+4>=c},shift:function(t,e){var n=Object(a.a)(e,2),c=n[0],i=n[1];return Object(r.a)(Object(r.a)({},t),{},{x0:t.x0+c,y0:t.y0+i,x1:t.x1+c,y1:t.y1+i})}})},function(t,e,n){},,function(t,e,n){"use strict";n.r(e);var r,a=n(3),c=n.n(a),i=n(11),o=n.n(i),u=(n(19),n(2)),s=n(0),l=(n(20),n(6));function d(){return(t=n(21),t.keys().map(t)).map((function(t){return function(t){if("object"!==typeof t||null==t||!Object(l.b)(Reflect.get(t,"config")))throw new TypeError("*.element.ts files must be a module exporting `config` object")}(t),t.config}));var t}var f=0;n(24);var h=n(4);function b(t){return Object(h.jsx)("div",{className:"Island"+(t.className?" ".concat(t.className):""),children:t.children})}var v=n(13),m=n(14),p=n(1),j=n(8);function O(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{value:t,next:n,prev:e}}var y=Object(j.a)("maxLength"),x=Object(j.a)("size"),E=Object(j.a)("head"),w=Object(j.a)("curNode"),g=function(){function t(e,n){Object(v.a)(this,t),Object.defineProperty(this,y,{writable:!0,value:void 0}),Object.defineProperty(this,x,{writable:!0,value:1}),Object.defineProperty(this,E,{writable:!0,value:void 0}),Object.defineProperty(this,w,{writable:!0,value:void 0}),Object(p.a)(this,E)[E]=Object(p.a)(this,w)[w]=O(e),Object(p.a)(this,y)[y]=n}return Object(m.a)(t,[{key:"get",value:function(){return Object(p.a)(this,w)[w].value}},{key:"push",value:function(t){var e=O(t,Object(p.a)(this,w)[w]);for(Object(p.a)(this,w)[w].next=e,Object(p.a)(this,w)[w]=e,Object(p.a)(this,x)[x]++;Object(p.a)(this,x)[x]>Object(p.a)(this,y)[y]&&Object(p.a)(this,E)[E].next;)Object(p.a)(this,w)[w]===Object(p.a)(this,E)[E]&&Object(p.a)(this,w)[w].next&&(Object(p.a)(this,w)[w]=Object(p.a)(this,w)[w].next,Object(p.a)(this,w)[w].prev=null),Object(p.a)(this,E)[E]=Object(p.a)(this,E)[E].next,Object(p.a)(this,E)[E].prev=null,Object(p.a)(this,x)[x]--;return this}},{key:"goBack",value:function(){return null!=Object(p.a)(this,w)[w].prev&&(Object(p.a)(this,w)[w]=Object(p.a)(this,w)[w].prev,Object(p.a)(this,x)[x]--),this}},{key:"goForward",value:function(){return null!=Object(p.a)(this,w)[w].next&&(Object(p.a)(this,w)[w]=Object(p.a)(this,w)[w].next,Object(p.a)(this,x)[x]++),this}},{key:"hasPrev",value:function(){return null!=Object(p.a)(this,w)[w].prev}},{key:"hasNext",value:function(){return null!=Object(p.a)(this,w)[w].next}}],[{key:"of",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return new t(e,n)}}]),t}(),P=null!=r?r:r=d().reduce((function(t,e){return t[e.name]=e,t}),{}),M=Object.keys(P),k={drawElements:[],draftElement:null,selectedElements:[],hoveredElement:null,activeTool:M[0],scrollPoint:[0,0]};function D(t){return{type:"updateScrollPoint",scrollPointShift:t}}function L(t){return{type:"setDrawElements",drawElements:t}}function B(t,e){switch(e.type){case"createDraftElement":return Object(s.a)(Object(s.a)({},t),{},{draftElement:e.element,selectedElements:[]});case"selectElement":return Object(s.a)(Object(s.a)({},t),{},{selectedElements:e.drawElementId?[e.drawElementId]:[]});case"updateDraftElement":return t.draftElement?Object(s.a)(Object(s.a)({},t),{},{draftElement:Object(s.a)(Object(s.a)({},t.draftElement),{},{props:Object(s.a)(Object(s.a)({},t.draftElement.props),e.props)})}):t;case"saveDraftElement":return t.draftElement?Object(s.a)(Object(s.a)({},t),{},{drawElements:t.drawElements.concat(t.draftElement),selectedElements:[t.draftElement.id],draftElement:null}):t;case"setActiveTool":return Object(s.a)(Object(s.a)({},t),{},{activeTool:e.tool});case"setDrawElements":return Object(s.a)(Object(s.a)({},t),{},{drawElements:e.drawElements});case"updateScrollPoint":return Object(s.a)(Object(s.a)({},t),{},{scrollPoint:[t.scrollPoint[0]+e.scrollPointShift[0],t.scrollPoint[1]+e.scrollPointShift[1]]});case"setHoveredElement":return Object(s.a)(Object(s.a)({},t),{},{hoveredElement:e.drawElementId});case"dragSelectedDrawElements":var n=new Set(t.selectedElements);return Object(s.a)(Object(s.a)({},t),{},{drawElements:t.drawElements.map((function(t){if(n.has(t.id)){var r=P[t.type];return Object(s.a)(Object(s.a)({},t),{},{props:r.shift(t.props,e.shift)})}return t}))})}}var S="crosshair";function C(t,e){for(var n=null,r=t.length-1;r>=0;r--){var a=t[r];if(P[a.type].containsPoint(a.props,e)){n=a;break}}return n}var N=function(){var t=Object(a.useRef)(null),e=Object(a.useReducer)(B,k),n=Object(u.a)(e,2),r=n[0],c=n[1],i=function(t){var e=Object(a.useState)((function(){return g.of(t)})),n=Object(u.a)(e,1)[0],r=Object(a.useState)(n.hasNext()),c=Object(u.a)(r,2),i=c[0],o=c[1],s=Object(a.useState)(n.hasPrev()),l=Object(u.a)(s,2),d=l[0],f=l[1];return Object(a.useEffect)((function(){n.get()!==t&&(n.push(t),f(n.hasPrev()),o(n.hasNext()))}),[n,t]),{hasPrev:d,hasNext:i,goBack:function(){return n.goBack(),f(n.hasPrev()),o(n.hasNext()),n.get()},goForward:function(){return n.goForward(),f(n.hasPrev()),o(n.hasNext()),n.get()}}}(r.drawElements);!function(t,e){var n=Object(a.useRef)(t);n.current=t,Object(a.useEffect)((function(){function t(){var t=e.current;if(t){var r=window.devicePixelRatio||1;t.width=window.innerWidth*r,t.height=window.innerHeight*r,t.style.width=window.innerWidth+"px",t.style.height=window.innerHeight+"px";var a=t.getContext("2d");null!=a&&(a.scale(r,r),T(a,n.current.drawElements,n.current.draftElement,n.current.selectedElements,n.current.scrollPoint))}}return window.addEventListener("resize",t),t(),function(){window.removeEventListener("resize",t)}}),[e])}(r,t);var o=Object(a.useRef)(r.draftElement);o.current=r.draftElement;var s=Object(a.useRef)(r.drawElements);return s.current=r.drawElements,Object(a.useEffect)((function(){var e=P[r.activeTool],n=0,a=0;function i(i){if(i.target===t.current){if(i.preventDefault(),n=i.clientX,a=i.clientY,1===i.buttons){var o=C(s.current,[i.clientX-r.scrollPoint[0],i.clientY-r.scrollPoint[1]]);if(o)return c({type:"selectElement",drawElementId:o.id}),document.addEventListener("pointermove",d),void document.addEventListener("pointerup",h);c({type:"createDraftElement",element:{id:(f++,(Date.now()+f).toString(32)),type:r.activeTool,props:e.onCreate(i.clientX-r.scrollPoint[0],i.clientY-r.scrollPoint[1])}}),document.addEventListener("pointermove",b),document.addEventListener("pointerup",v)}4===i.buttons&&(t.current&&(t.current.style.cursor="grab"),document.addEventListener("pointermove",u),document.addEventListener("pointerup",l))}}function u(t){var e=t.clientX-n,r=t.clientY-a;c(D([e,r])),n=t.clientX,a=t.clientY}function l(){t.current&&(t.current.style.cursor=S),document.removeEventListener("pointermove",u),document.removeEventListener("pointerup",l)}function d(t){var e=t.clientX-n,r=t.clientY-a;c({type:"dragSelectedDrawElements",shift:[e,r]}),n=t.clientX,a=t.clientY}function h(){t.current&&(t.current.style.cursor=S),document.removeEventListener("pointermove",d),document.removeEventListener("pointerup",h)}function b(t){null!=o.current&&(c({type:"updateDraftElement",props:e.onDrawing(t.clientX-n,t.clientY-a,o.current.props)}),n=t.clientX,a=t.clientY)}function v(){c({type:"saveDraftElement"}),document.removeEventListener("pointermove",b),document.removeEventListener("pointerup",v)}function m(t){c(D([-t.deltaX,-t.deltaY]))}return document.addEventListener("wheel",m),document.addEventListener("pointerdown",i),function(){document.removeEventListener("pointerdown",i),document.removeEventListener("wheel",m)}}),[r.activeTool,r.hoveredElement,r.scrollPoint]),Object(a.useEffect)((function(){var e,n=null===(e=t.current)||void 0===e?void 0:e.getContext("2d");null!=n&&T(n,r.drawElements,r.draftElement,r.selectedElements,r.scrollPoint)}),[r.drawElements,r.draftElement,r.scrollPoint,r.selectedElements]),Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)(b,{className:"App__toolbar",children:M.map((function(t){return Object(h.jsx)("button",{disabled:r.activeTool===t,onClick:function(){return c({type:"setActiveTool",tool:t})},children:t},t)}))}),Object(h.jsxs)(b,{className:"App__toolbar",children:[Object(h.jsx)("button",{disabled:!i.hasPrev,onClick:function(){if(i.hasPrev){var t=i.goBack();c(L(t))}},children:"\u2190"}),Object(h.jsx)("button",{disabled:!i.hasNext,onClick:function(){if(i.hasNext){var t=i.goForward();c(L(t))}},children:"\u2192"})]}),Object(h.jsx)("canvas",{className:"App__canvas",ref:t,onMouseMove:function(e){var n;if(e.target===t.current){var a=C(r.drawElements,[e.clientX-r.scrollPoint[0],e.clientY-r.scrollPoint[1]]);t.current.style.cursor=a?"move":S,c({type:"setHoveredElement",drawElementId:null!==(n=null===a||void 0===a?void 0:a.id)&&void 0!==n?n:null})}}})]})};function T(t,e,n,r,a){var c=Object(u.a)(a,2),i=c[0],o=c[1];t.clearRect(0,0,t.canvas.width,t.canvas.height),t.translate(i,o),e.forEach((function(e){P[e.type].draw(e.props,t)})),n&&P[n.type].draw(n.props,t);var s=new Set(r);e.forEach((function(e){s.has(e.id)&&function(t,e){e.save();var n=P[t.type].getBoundingBox(t.props);e.lineWidth=1,e.strokeStyle="blue",e.setLineDash(_),e.strokeRect(n.x-6,n.y-6,n.width+12,n.height+12),e.restore()}(e,t)})),t.translate(-i,-o)}var _=[5,5];var Y=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,28)).then((function(e){var n=e.getCLS,r=e.getFID,a=e.getFCP,c=e.getLCP,i=e.getTTFB;n(t),r(t),a(t),c(t),i(t)}))};o.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(N,{})}),document.getElementById("root")),Y()},function(t,e,n){"use strict";n.r(e),n.d(e,"config",(function(){return s}));var r=n(0),a=n(5),c=n(2),i=n(6),o=n(12);function u(t,e,n){var r=function(t){if(!t.length)return"";var e=t.reduce((function(t,e,n,r){var a=Object(c.a)(e,2),i=a[0],o=a[1],u=Object(c.a)(r[(n+1)%r.length],2),s=u[0],l=u[1];return t.push(i,o,(i+s)/2,(o+l)/2),t}),["M"].concat(Object(a.a)(t[0]),["Q"]));return e.push("Z"),e.join(" ")}(Object(o.a)(t));n.fillStyle=e,n.fill(new Path2D(r))}var s=Object(i.a)({name:"Draw",draw:function(t,e){0!==t.points.length&&u(t.points,t.color,e)},onCreate:function(t,e){return{color:"black",points:[[t,e]]}},onDrawing:function(t,e,n){var r=Object(c.a)(n.points[n.points.length-1],2),i=r[0],o=r[1];return{points:[].concat(Object(a.a)(n.points),[[i+t,o+e]])}},getBoundingBox:function(t){var e=Math.min.apply(Math,Object(a.a)(t.points.map((function(t){return t[0]})))),n=Math.min.apply(Math,Object(a.a)(t.points.map((function(t){return t[1]}))));return{x:e,y:n,width:Math.max.apply(Math,Object(a.a)(t.points.map((function(t){return t[0]}))))-e,height:Math.max.apply(Math,Object(a.a)(t.points.map((function(t){return t[1]}))))-n}},containsPoint:function(t,e){var n=Object(c.a)(e,2),r=n[0],i=n[1],o=Math.min.apply(Math,Object(a.a)(t.points.map((function(t){return t[0]})))),u=Math.min.apply(Math,Object(a.a)(t.points.map((function(t){return t[1]})))),s=Math.max.apply(Math,Object(a.a)(t.points.map((function(t){return t[0]})))),l=Math.max.apply(Math,Object(a.a)(t.points.map((function(t){return t[1]}))));return Math.min(o,s)<=r&&Math.max(o,s)>=r&&Math.min(u,l)<=i&&Math.max(u,l)>=i},shift:function(t,e){var n=Object(c.a)(e,2),a=n[0],i=n[1];return Object(r.a)(Object(r.a)({},t),{},{points:t.points.map((function(t){var e=Object(c.a)(t,2),n=e[0],r=e[1];return[n+a,r+i]}))})}})}],[[26,1,2]]]);
//# sourceMappingURL=main.65dcdbcc.chunk.js.map
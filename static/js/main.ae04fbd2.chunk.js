(this.webpackJsonpmydraw=this.webpackJsonpmydraw||[]).push([[0],[,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(2),a=n(0),c=new WeakMap;function i(e){var t=Object(a.a)(Object(a.a)({},e),{},{__TYPE__:"DrawElementConfig",getBoundingBox:function(t){return c.has(t)||c.set(t,e.getBoundingBox(t)),c.get(t)},containsPoint:function(n,a){var c=t.getBoundingBox(n),i=Object(r.a)(a,2),o=i[0],u=i[1];return!!(c.x-10<=o&&c.x+c.width+10>=o&&c.y-10<=u&&c.y+c.height+10>=u)&&e.containsPoint(n,a)}});return t}function o(e){return"object"===typeof e&&null!=e&&"DrawElementConfig"===Reflect.get(e,"__TYPE__")}},,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){var r={"./Draw.element.ts":27,"./Line.element.ts":22,"./Rect.element.ts":23};function a(e){var t=c(e);return n(t)}function c(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=c,e.exports=a,a.id=21},function(e,t,n){"use strict";n.r(t),n.d(t,"config",(function(){return i}));var r=n(0),a=n(2),c=n(6),i=Object(c.a)({name:"Line",draw:function(e,t){t.lineWidth=4,t.strokeStyle=e.color,t.beginPath(),t.moveTo(e.x0,e.y0),t.lineTo(e.x1,e.y1),t.stroke()},onCreate:function(e,t){return{color:"#000000",x0:e,y0:t,x1:e,y1:t}},onDrawing:function(e,t,n){return{x1:n.x1+e,y1:n.y1+t}},getBoundingBox:function(e){return{x:Math.min(e.x0,e.x1),y:Math.min(e.y0,e.y1),width:Math.abs(e.x0-e.x1),height:Math.abs(e.y0-e.y1)}},containsPoint:function(e,t){var n=Object(a.a)(t,2),r=n[0],c=n[1];return Math.min(e.x0,e.x1)<=r&&Math.max(e.x0,e.x1)>=r&&Math.min(e.y0,e.y1)<=c&&Math.max(e.y0,e.y1)>=c},shift:function(e,t){var n=Object(a.a)(t,2),c=n[0],i=n[1];return Object(r.a)(Object(r.a)({},e),{},{x0:e.x0+c,y0:e.y0+i,x1:e.x1+c,y1:e.y1+i})}})},function(e,t,n){"use strict";n.r(t),n.d(t,"config",(function(){return i}));var r=n(0),a=n(2),c=n(6),i=Object(c.a)({name:"Rect",draw:function(e,t){t.lineWidth=4,t.strokeStyle=e.strokeColor,t.fillStyle=e.backgroundColor,t.beginPath(),t.rect(e.x0,e.y0,e.x1-e.x0,e.y1-e.y0),t.fill(),t.stroke()},onCreate:function(e,t){return{backgroundColor:"transparent",strokeColor:"black",x0:e,y0:t,x1:e,y1:t}},onDrawing:function(e,t,n){return{x1:n.x1+e,y1:n.y1+t}},getBoundingBox:function(e){return{x:Math.min(e.x0,e.x1),y:Math.min(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)}},containsPoint:function(e,t){var n=Object(a.a)(t,2),r=n[0],c=n[1];return Math.min(e.x0,e.x1)-4<=r&&Math.max(e.x0,e.x1)+4>=r&&Math.min(e.y0,e.y1)-4<=c&&Math.max(e.y0,e.y1)+4>=c},shift:function(e,t){var n=Object(a.a)(t,2),c=n[0],i=n[1];return Object(r.a)(Object(r.a)({},e),{},{x0:e.x0+c,y0:e.y0+i,x1:e.x1+c,y1:e.y1+i})}})},function(e,t,n){},,function(e,t,n){"use strict";n.r(t);var r,a=n(3),c=n.n(a),i=n(11),o=n.n(i),u=(n(19),n(2)),s=n(0),l=(n(20),n(6));function d(){return(e=n(21),e.keys().map(e)).map((function(e){return function(e){if("object"!==typeof e||null==e||!Object(l.b)(Reflect.get(e,"config")))throw new TypeError("*.element.ts files must be a module exporting `config` object")}(e),e.config}));var e}var f=0;n(24);var h=n(4);function b(e){return Object(h.jsx)("div",{className:"Island"+(e.className?" ".concat(e.className):""),children:e.children})}var v=n(13),m=n(14),p=n(1),j=n(8);function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{value:e,next:n,prev:t}}var y=Object(j.a)("maxLength"),x=Object(j.a)("size"),E=Object(j.a)("head"),w=Object(j.a)("curNode"),g=function(){function e(t,n){Object(v.a)(this,e),Object.defineProperty(this,y,{writable:!0,value:void 0}),Object.defineProperty(this,x,{writable:!0,value:1}),Object.defineProperty(this,E,{writable:!0,value:void 0}),Object.defineProperty(this,w,{writable:!0,value:void 0}),Object(p.a)(this,E)[E]=Object(p.a)(this,w)[w]=O(t),Object(p.a)(this,y)[y]=n}return Object(m.a)(e,[{key:"get",value:function(){return Object(p.a)(this,w)[w].value}},{key:"push",value:function(e){var t=O(e,Object(p.a)(this,w)[w]);for(Object(p.a)(this,w)[w].next=t,Object(p.a)(this,w)[w]=t,Object(p.a)(this,x)[x]++;Object(p.a)(this,x)[x]>Object(p.a)(this,y)[y]&&Object(p.a)(this,E)[E].next;)Object(p.a)(this,w)[w]===Object(p.a)(this,E)[E]&&Object(p.a)(this,w)[w].next&&(Object(p.a)(this,w)[w]=Object(p.a)(this,w)[w].next,Object(p.a)(this,w)[w].prev=null),Object(p.a)(this,E)[E]=Object(p.a)(this,E)[E].next,Object(p.a)(this,E)[E].prev=null,Object(p.a)(this,x)[x]--;return this}},{key:"goBack",value:function(){return null!=Object(p.a)(this,w)[w].prev&&(Object(p.a)(this,w)[w]=Object(p.a)(this,w)[w].prev,Object(p.a)(this,x)[x]--),this}},{key:"goForward",value:function(){return null!=Object(p.a)(this,w)[w].next&&(Object(p.a)(this,w)[w]=Object(p.a)(this,w)[w].next,Object(p.a)(this,x)[x]++),this}},{key:"hasPrev",value:function(){return null!=Object(p.a)(this,w)[w].prev}},{key:"hasNext",value:function(){return null!=Object(p.a)(this,w)[w].next}}],[{key:"of",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return new e(t,n)}}]),e}(),P=null!=r?r:r=d().reduce((function(e,t){return e[t.name]=t,e}),{}),M=Object.keys(P),k={drawElements:[],draftElement:null,selectedElements:[],hoveredElement:null,activeTool:M[0],scrollPoint:[0,0]};function D(e){return{type:"updateScrollPoint",scrollPointShift:e}}function L(e){return{type:"setDrawElements",drawElements:e}}function B(e,t){switch(t.type){case"createDraftElement":return Object(s.a)(Object(s.a)({},e),{},{draftElement:t.element,selectedElements:[]});case"selectElement":return Object(s.a)(Object(s.a)({},e),{},{selectedElements:t.drawElementId?[t.drawElementId]:[]});case"updateDraftElement":return e.draftElement?Object(s.a)(Object(s.a)({},e),{},{draftElement:Object(s.a)(Object(s.a)({},e.draftElement),{},{props:Object(s.a)(Object(s.a)({},e.draftElement.props),t.props)})}):e;case"saveDraftElement":return e.draftElement?Object(s.a)(Object(s.a)({},e),{},{drawElements:e.drawElements.concat(e.draftElement),selectedElements:[e.draftElement.id],draftElement:null}):e;case"setActiveTool":return Object(s.a)(Object(s.a)({},e),{},{activeTool:t.tool});case"setDrawElements":return Object(s.a)(Object(s.a)({},e),{},{drawElements:t.drawElements});case"updateScrollPoint":return Object(s.a)(Object(s.a)({},e),{},{scrollPoint:[e.scrollPoint[0]+t.scrollPointShift[0],e.scrollPoint[1]+t.scrollPointShift[1]]});case"setHoveredElement":return Object(s.a)(Object(s.a)({},e),{},{hoveredElement:t.drawElementId});case"dragSelectedDrawElements":var n=new Set(e.selectedElements);return Object(s.a)(Object(s.a)({},e),{},{drawElements:e.drawElements.map((function(e){if(n.has(e.id)){var r=P[e.type];return Object(s.a)(Object(s.a)({},e),{},{props:r.shift(e.props,t.shift)})}return e}))})}}var S="crosshair";var C=function(){var e=Object(a.useRef)(null),t=Object(a.useReducer)(B,k),n=Object(u.a)(t,2),r=n[0],c=n[1],i=function(e){var t=Object(a.useState)((function(){return g.of(e)})),n=Object(u.a)(t,1)[0],r=Object(a.useState)(n.hasNext()),c=Object(u.a)(r,2),i=c[0],o=c[1],s=Object(a.useState)(n.hasPrev()),l=Object(u.a)(s,2),d=l[0],f=l[1];return Object(a.useEffect)((function(){n.get()!==e&&(n.push(e),f(n.hasPrev()),o(n.hasNext()))}),[n,e]),{hasPrev:d,hasNext:i,goBack:function(){return n.goBack(),f(n.hasPrev()),o(n.hasNext()),n.get()},goForward:function(){return n.goForward(),f(n.hasPrev()),o(n.hasNext()),n.get()}}}(r.drawElements);!function(e,t){var n=Object(a.useRef)(e);n.current=e,Object(a.useEffect)((function(){function e(){var e=t.current;if(e){var r=window.devicePixelRatio||1;e.width=window.innerWidth*r,e.height=window.innerHeight*r,e.style.width=window.innerWidth+"px",e.style.height=window.innerHeight+"px";var a=e.getContext("2d");null!=a&&(a.scale(r,r),N(a,n.current.drawElements,n.current.draftElement,n.current.selectedElements,n.current.scrollPoint))}}return window.addEventListener("resize",e),e(),function(){window.removeEventListener("resize",e)}}),[t])}(r,e);var o=Object(a.useRef)(r.draftElement);return o.current=r.draftElement,Object(a.useEffect)((function(){var t=P[r.activeTool],n=0,a=0;function i(i){if(i.target===e.current){if(i.preventDefault(),n=i.clientX,a=i.clientY,1===i.buttons){if(r.hoveredElement)return c({type:"selectElement",drawElementId:r.hoveredElement}),document.addEventListener("pointermove",l),void document.addEventListener("pointerup",d);c({type:"createDraftElement",element:{id:(f++,(Date.now()+f).toString(32)),type:r.activeTool,props:t.onCreate(i.clientX-r.scrollPoint[0],i.clientY-r.scrollPoint[1])}}),document.addEventListener("pointermove",h),document.addEventListener("pointerup",b)}4===i.buttons&&(e.current&&(e.current.style.cursor="grab"),document.addEventListener("pointermove",u),document.addEventListener("pointerup",s))}}function u(e){var t=e.clientX-n,r=e.clientY-a;c(D([t,r])),n=e.clientX,a=e.clientY}function s(){e.current&&(e.current.style.cursor=S),document.removeEventListener("pointermove",u),document.removeEventListener("pointerup",s)}function l(e){var t=e.clientX-n,r=e.clientY-a;c({type:"dragSelectedDrawElements",shift:[t,r]}),n=e.clientX,a=e.clientY}function d(){e.current&&(e.current.style.cursor=S),document.removeEventListener("pointermove",l),document.removeEventListener("pointerup",d)}function h(e){null!=o.current&&(c({type:"updateDraftElement",props:t.onDrawing(e.clientX-n,e.clientY-a,o.current.props)}),n=e.clientX,a=e.clientY)}function b(){c({type:"saveDraftElement"}),document.removeEventListener("pointermove",h),document.removeEventListener("pointerup",b)}function v(e){c(D([-e.deltaX,-e.deltaY]))}return document.addEventListener("wheel",v),document.addEventListener("pointerdown",i),function(){document.removeEventListener("pointerdown",i),document.removeEventListener("wheel",v)}}),[r.activeTool,r.hoveredElement,r.scrollPoint]),Object(a.useEffect)((function(){var t,n=null===(t=e.current)||void 0===t?void 0:t.getContext("2d");null!=n&&N(n,r.drawElements,r.draftElement,r.selectedElements,r.scrollPoint)}),[r.drawElements,r.draftElement,r.scrollPoint,r.selectedElements]),Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)(b,{className:"App__toolbar",children:M.map((function(e){return Object(h.jsx)("button",{disabled:r.activeTool===e,onClick:function(){return c({type:"setActiveTool",tool:e})},children:e},e)}))}),Object(h.jsxs)(b,{className:"App__toolbar",children:[Object(h.jsx)("button",{disabled:!i.hasPrev,onClick:function(){if(i.hasPrev){var e=i.goBack();c(L(e))}},children:"\u2190"}),Object(h.jsx)("button",{disabled:!i.hasNext,onClick:function(){if(i.hasNext){var e=i.goForward();c(L(e))}},children:"\u2192"})]}),Object(h.jsx)("canvas",{className:"App__canvas",ref:e,onMouseMove:function(t){var n;if(t.target===e.current){var a=function(e,t){for(var n=null,r=e.length-1;r>=0;r--){var a=e[r];if(P[a.type].containsPoint(a.props,t)){n=a;break}}return n}(r.drawElements,[t.clientX-r.scrollPoint[0],t.clientY-r.scrollPoint[1]]);e.current.style.cursor=a?"move":S,c({type:"setHoveredElement",drawElementId:null!==(n=null===a||void 0===a?void 0:a.id)&&void 0!==n?n:null})}}})]})};function N(e,t,n,r,a){var c=Object(u.a)(a,2),i=c[0],o=c[1];e.clearRect(0,0,e.canvas.width,e.canvas.height),e.translate(i,o),t.forEach((function(t){P[t.type].draw(t.props,e)})),n&&P[n.type].draw(n.props,e);var s=new Set(r);t.forEach((function(t){s.has(t.id)&&function(e,t){t.save();var n=P[e.type].getBoundingBox(e.props);t.lineWidth=1,t.strokeStyle="blue",t.setLineDash(T),t.strokeRect(n.x-6,n.y-6,n.width+12,n.height+12),t.restore()}(t,e)})),e.translate(-i,-o)}var T=[5,5];var _=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,28)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))};o.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(C,{})}),document.getElementById("root")),_()},function(e,t,n){"use strict";n.r(t),n.d(t,"config",(function(){return s}));var r=n(0),a=n(5),c=n(2),i=n(6),o=n(12);function u(e,t,n){var r=function(e){if(!e.length)return"";var t=e.reduce((function(e,t,n,r){var a=Object(c.a)(t,2),i=a[0],o=a[1],u=Object(c.a)(r[(n+1)%r.length],2),s=u[0],l=u[1];return e.push(i,o,(i+s)/2,(o+l)/2),e}),["M"].concat(Object(a.a)(e[0]),["Q"]));return t.push("Z"),t.join(" ")}(Object(o.a)(e));n.fillStyle=t,n.fill(new Path2D(r))}var s=Object(i.a)({name:"Draw",draw:function(e,t){0!==e.points.length&&u(e.points,e.color,t)},onCreate:function(e,t){return{color:"black",points:[[e,t]]}},onDrawing:function(e,t,n){var r=Object(c.a)(n.points[n.points.length-1],2),i=r[0],o=r[1];return{points:[].concat(Object(a.a)(n.points),[[i+e,o+t]])}},getBoundingBox:function(e){var t=Math.min.apply(Math,Object(a.a)(e.points.map((function(e){return e[0]})))),n=Math.min.apply(Math,Object(a.a)(e.points.map((function(e){return e[1]}))));return{x:t,y:n,width:Math.max.apply(Math,Object(a.a)(e.points.map((function(e){return e[0]}))))-t,height:Math.max.apply(Math,Object(a.a)(e.points.map((function(e){return e[1]}))))-n}},containsPoint:function(e,t){var n=Object(c.a)(t,2),r=n[0],i=n[1],o=Math.min.apply(Math,Object(a.a)(e.points.map((function(e){return e[0]})))),u=Math.min.apply(Math,Object(a.a)(e.points.map((function(e){return e[1]})))),s=Math.max.apply(Math,Object(a.a)(e.points.map((function(e){return e[0]})))),l=Math.max.apply(Math,Object(a.a)(e.points.map((function(e){return e[1]}))));return Math.min(o,s)<=r&&Math.max(o,s)>=r&&Math.min(u,l)<=i&&Math.max(u,l)>=i},shift:function(e,t){var n=Object(c.a)(t,2),a=n[0],i=n[1];return Object(r.a)(Object(r.a)({},e),{},{points:e.points.map((function(e){var t=Object(c.a)(e,2),n=t[0],r=t[1];return[n+a,r+i]}))})}})}],[[26,1,2]]]);
//# sourceMappingURL=main.ae04fbd2.chunk.js.map
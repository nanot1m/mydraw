(this.webpackJsonpmydraw=this.webpackJsonpmydraw||[]).push([[0],[,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return a}));var r=n(1);function c(e){return Object(r.a)(Object(r.a)({},e),{},{__TYPE__:"DrawElementConfig"})}function a(e){return"object"===typeof e&&null!=e&&"DrawElementConfig"===Reflect.get(e,"__TYPE__")}},,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){var r={"./Draw.element.ts":27,"./Line.element.ts":22,"./Rect.element.ts":23};function c(e){var t=a(e);return n(t)}function a(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}c.keys=function(){return Object.keys(r)},c.resolve=a,e.exports=c,c.id=21},function(e,t,n){"use strict";n.r(t),n.d(t,"config",(function(){return c}));var r=n(5),c=Object(r.a)({name:"Line",draw:function(e,t){t.lineWidth=4,t.strokeStyle=e.color,t.beginPath(),t.moveTo(e.x0,e.y0),t.lineTo(e.x1,e.y1),t.stroke()},onCreate:function(e,t){return{color:"#000000",x0:e,y0:t,x1:e,y1:t}},onDrawing:function(e,t,n){return{x1:n.x1+e,y1:n.y1+t}}})},function(e,t,n){"use strict";n.r(t),n.d(t,"config",(function(){return c}));var r=n(5),c=Object(r.a)({name:"Rect",draw:function(e,t){t.lineWidth=4,t.strokeStyle=e.strokeColor,t.fillStyle=e.backgroundColor,t.beginPath(),t.rect(e.x0,e.y0,e.x1-e.x0,e.y1-e.y0),t.fill(),t.stroke()},onCreate:function(e,t){return{backgroundColor:"pink",strokeColor:"black",x0:e,y0:t,x1:e,y1:t}},onDrawing:function(e,t,n){return{x1:n.x1+e,y1:n.y1+t}}})},function(e,t,n){},,function(e,t,n){"use strict";n.r(t);var r,c=n(2),a=n.n(c),o=n(11),i=n.n(o),u=(n(19),n(4)),s=n(1),l=(n(20),n(5));function f(){return(e=n(21),e.keys().map(e)).map((function(e){return function(e){if("object"!==typeof e||null==e||!Object(l.b)(Reflect.get(e,"config")))throw new TypeError("*.element.ts files must be a module exporting `config` object")}(e),e.config}));var e}var d=0;n(24);var b=n(3);function j(e){return Object(b.jsx)("div",{className:"Island"+(e.className?" ".concat(e.className):""),children:e.children})}var h=n(13),v=n(14),O=n(0),p=n(7);function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{value:e,next:n,prev:t}}var w=Object(p.a)("maxLength"),g=Object(p.a)("size"),E=Object(p.a)("head"),y=Object(p.a)("curNode"),x=function(){function e(t,n){Object(h.a)(this,e),Object.defineProperty(this,w,{writable:!0,value:void 0}),Object.defineProperty(this,g,{writable:!0,value:1}),Object.defineProperty(this,E,{writable:!0,value:void 0}),Object.defineProperty(this,y,{writable:!0,value:void 0}),Object(O.a)(this,E)[E]=Object(O.a)(this,y)[y]=m(t),Object(O.a)(this,w)[w]=n}return Object(v.a)(e,[{key:"get",value:function(){return Object(O.a)(this,y)[y].value}},{key:"push",value:function(e){var t=m(e,Object(O.a)(this,y)[y]);for(Object(O.a)(this,y)[y].next=t,Object(O.a)(this,y)[y]=t,Object(O.a)(this,g)[g]++;Object(O.a)(this,g)[g]>Object(O.a)(this,w)[w]&&Object(O.a)(this,E)[E].next;)Object(O.a)(this,E)[E]=Object(O.a)(this,E)[E].next,Object(O.a)(this,g)[g]--;return this}},{key:"goBack",value:function(){return null!=Object(O.a)(this,y)[y].prev&&(Object(O.a)(this,y)[y]=Object(O.a)(this,y)[y].prev,Object(O.a)(this,g)[g]--),this}},{key:"goForward",value:function(){return null!=Object(O.a)(this,y)[y].next&&(Object(O.a)(this,y)[y]=Object(O.a)(this,y)[y].next,Object(O.a)(this,g)[g]++),this}},{key:"hasPrev",value:function(){return null!=Object(O.a)(this,y)[y].prev}},{key:"hasNext",value:function(){return null!=Object(O.a)(this,y)[y].next}}],[{key:"of",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return new e(t,n)}}]),e}(),k=null!=r?r:r=f().reduce((function(e,t){return e[t.name]=t,e}),{}),D=Object.keys(k),P={drawElements:[],draftElement:null,activeTool:D[0]};function C(e){return{type:"setDrawElements",drawElements:e}}function N(e,t){switch(t.type){case"createDraftElement":return Object(s.a)(Object(s.a)({},e),{},{draftElement:t.element});case"updateDraftElement":return e.draftElement?Object(s.a)(Object(s.a)({},e),{},{draftElement:Object(s.a)(Object(s.a)({},e.draftElement),{},{props:Object(s.a)(Object(s.a)({},e.draftElement.props),t.props)})}):e;case"saveDraftElement":return e.draftElement?Object(s.a)(Object(s.a)({},e),{},{drawElements:e.drawElements.concat(e.draftElement),draftElement:null}):e;case"setActiveTool":return Object(s.a)(Object(s.a)({},e),{},{activeTool:t.tool});case"setDrawElements":return Object(s.a)(Object(s.a)({},e),{},{drawElements:t.drawElements})}}var T=function(){var e=Object(c.useRef)(null),t=Object(c.useReducer)(N,P),n=Object(u.a)(t,2),r=n[0],a=n[1],o=function(e){var t=Object(c.useState)((function(){return x.of(e)})),n=Object(u.a)(t,1)[0],r=Object(c.useState)(n.hasNext()),a=Object(u.a)(r,2),o=a[0],i=a[1],s=Object(c.useState)(n.hasPrev()),l=Object(u.a)(s,2),f=l[0],d=l[1];return Object(c.useEffect)((function(){n.get()!==e&&(n.push(e),d(n.hasPrev()),i(n.hasNext()))}),[n,e]),{hasPrev:f,hasNext:o,goBack:function(){return n.goBack(),d(n.hasPrev()),i(n.hasNext()),n.get()},goForward:function(){return n.goForward(),d(n.hasPrev()),i(n.hasNext()),n.get()}}}(r.drawElements);Object(c.useEffect)((function(){function t(){var t,n=e.current;if(n){var r=window.devicePixelRatio||1;n.width=window.innerWidth*r,n.height=window.innerHeight*r,n.style.width=window.innerWidth+"px",n.style.height=window.innerHeight+"px",null===(t=n.getContext("2d"))||void 0===t||t.scale(r,r)}}return window.addEventListener("resize",t),t(),function(){window.removeEventListener("resize",t)}}),[]);var i=Object(c.useRef)(r.draftElement);return i.current=r.draftElement,Object(c.useEffect)((function(){var e=k[r.activeTool],t=0,n=0;function c(r){null!=i.current&&(a({type:"updateDraftElement",props:e.onDrawing(r.clientX-t,r.clientY-n,i.current.props)}),t=r.clientX,n=r.clientY)}function o(o){1===o.buttons&&(t=o.clientX,n=o.clientY,a({type:"createDraftElement",element:{id:(d++,(Date.now()+d).toString(32)),type:r.activeTool,props:e.onCreate(o.clientX,o.clientY)}}),document.addEventListener("pointermove",c))}function u(){a({type:"saveDraftElement"}),document.removeEventListener("pointermove",c)}return document.addEventListener("pointerdown",o),document.addEventListener("pointerup",u),function(){document.removeEventListener("pointerdown",o),document.removeEventListener("pointerup",u)}}),[r.activeTool]),Object(c.useEffect)((function(){var t=e.current;if(null!=t){var n=t.getContext("2d");null!=n&&(n.clearRect(0,0,t.width,t.height),r.drawElements.forEach((function(e){k[e.type].draw(e.props,n)})),r.draftElement&&k[r.draftElement.type].draw(r.draftElement.props,n))}}),[r.drawElements,r.draftElement]),Object(b.jsxs)("div",{className:"App",children:[Object(b.jsxs)("div",{onPointerDown:function(e){return e.stopPropagation()},children:[Object(b.jsx)(j,{className:"App__toolbar",children:D.map((function(e){return Object(b.jsx)("button",{disabled:r.activeTool===e,onClick:function(){return a({type:"setActiveTool",tool:e})},children:e},e)}))}),Object(b.jsxs)(j,{className:"App__toolbar",children:[Object(b.jsx)("button",{disabled:!o.hasPrev,onClick:function(){if(o.hasPrev){var e=o.goBack();a(C(e))}},children:"\u2190"}),Object(b.jsx)("button",{disabled:!o.hasNext,onClick:function(){if(o.hasNext){var e=o.goForward();a(C(e))}},children:"\u2192"})]})]}),Object(b.jsx)("canvas",{className:"App__canvas",ref:e})]})},_=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,28)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),c(e),a(e),o(e)}))};i.a.render(Object(b.jsx)(a.a.StrictMode,{children:Object(b.jsx)(T,{})}),document.getElementById("root")),_()},function(e,t,n){"use strict";n.r(t),n.d(t,"config",(function(){return u}));var r=n(9),c=n(4),a=n(5),o=n(12);function i(e,t,n){var a=function(e){if(!e.length)return"";var t=e.reduce((function(e,t,n,r){var a=Object(c.a)(t,2),o=a[0],i=a[1],u=Object(c.a)(r[(n+1)%r.length],2),s=u[0],l=u[1];return e.push(o,i,(o+s)/2,(i+l)/2),e}),["M"].concat(Object(r.a)(e[0]),["Q"]));return t.push("Z"),t.join(" ")}(Object(o.a)(e));n.fillStyle=t,n.fill(new Path2D(a))}var u=Object(a.a)({name:"Draw",draw:function(e,t){0!==e.points.length&&i(e.points,e.color,t)},onCreate:function(e,t){return{color:"black",points:[[e,t]]}},onDrawing:function(e,t,n){var a=Object(c.a)(n.points[n.points.length-1],2),o=a[0],i=a[1];return{points:[].concat(Object(r.a)(n.points),[[o+e,i+t]])}}})}],[[26,1,2]]]);
//# sourceMappingURL=main.6ba93f63.chunk.js.map
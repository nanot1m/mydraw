(this.webpackJsonpmydraw=this.webpackJsonpmydraw||[]).push([[0],[,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(2),a=n(1),c=new WeakMap;function o(e){var t=Object(a.a)(Object(a.a)({},e),{},{__TYPE__:"DrawElementConfig",getBoundingBox:function(t){return c.has(t)||c.set(t,e.getBoundingBox(t)),c.get(t)},containsPoint:function(n,a){var c=t.getBoundingBox(n),o=Object(r.a)(a,2),i=o[0],u=o[1];return!!(c.x-10<=i&&c.x+c.width+10>=i&&c.y-10<=u&&c.y+c.height+10>=u)&&e.containsPoint(n,a)}});return t}function i(e){return"object"===typeof e&&null!=e&&"DrawElementConfig"===Reflect.get(e,"__TYPE__")}},,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){var r={"./Draw.element.ts":27,"./Line.element.ts":22,"./Rect.element.ts":23};function a(e){var t=c(e);return n(t)}function c(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=c,e.exports=a,a.id=21},function(e,t,n){"use strict";n.r(t),n.d(t,"config",(function(){return c}));var r=n(2),a=n(6),c=Object(a.a)({name:"Line",draw:function(e,t){t.lineWidth=4,t.strokeStyle=e.color,t.beginPath(),t.moveTo(e.x0,e.y0),t.lineTo(e.x1,e.y1),t.stroke()},onCreate:function(e,t){return{color:"#000000",x0:e,y0:t,x1:e,y1:t}},onDrawing:function(e,t,n){return{x1:n.x1+e,y1:n.y1+t}},getBoundingBox:function(e){return{x:Math.min(e.x0,e.x1),y:Math.min(e.y0,e.y1),width:Math.abs(e.x0-e.x1),height:Math.abs(e.y0-e.y1)}},containsPoint:function(e,t){var n=Object(r.a)(t,2),a=n[0],c=n[1];return Math.min(e.x0,e.x1)<=a&&Math.max(e.x0,e.x1)>=a&&Math.min(e.y0,e.y1)<=c&&Math.max(e.y0,e.y1)>=c}})},function(e,t,n){"use strict";n.r(t),n.d(t,"config",(function(){return c}));var r=n(2),a=n(6),c=Object(a.a)({name:"Rect",draw:function(e,t){t.lineWidth=4,t.strokeStyle=e.strokeColor,t.fillStyle=e.backgroundColor,t.beginPath(),t.rect(e.x0,e.y0,e.x1-e.x0,e.y1-e.y0),t.fill(),t.stroke()},onCreate:function(e,t){return{backgroundColor:"transparent",strokeColor:"black",x0:e,y0:t,x1:e,y1:t}},onDrawing:function(e,t,n){return{x1:n.x1+e,y1:n.y1+t}},getBoundingBox:function(e){return{x:Math.min(e.x0,e.x1),y:Math.min(e.y0,e.y1),width:Math.abs(e.x1-e.x0),height:Math.abs(e.y1-e.y0)}},containsPoint:function(e,t){var n=Object(r.a)(t,2),a=n[0],c=n[1];return Math.min(e.x0,e.x1)-4<=a&&Math.max(e.x0,e.x1)+4>=a&&Math.min(e.y0,e.y1)-4<=c&&Math.max(e.y0,e.y1)+4>=c}})},function(e,t,n){},,function(e,t,n){"use strict";n.r(t);var r,a=n(3),c=n.n(a),o=n(11),i=n.n(o),u=(n(19),n(2)),l=n(1),s=(n(20),n(6));function d(){return(e=n(21),e.keys().map(e)).map((function(e){return function(e){if("object"!==typeof e||null==e||!Object(s.b)(Reflect.get(e,"config")))throw new TypeError("*.element.ts files must be a module exporting `config` object")}(e),e.config}));var e}var f=0;n(24);var h=n(4);function m(e){return Object(h.jsx)("div",{className:"Island"+(e.className?" ".concat(e.className):""),children:e.children})}var b=n(13),v=n(14),p=n(0),j=n(8);function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{value:e,next:n,prev:t}}var y=Object(j.a)("maxLength"),E=Object(j.a)("size"),x=Object(j.a)("head"),w=Object(j.a)("curNode"),g=function(){function e(t,n){Object(b.a)(this,e),Object.defineProperty(this,y,{writable:!0,value:void 0}),Object.defineProperty(this,E,{writable:!0,value:1}),Object.defineProperty(this,x,{writable:!0,value:void 0}),Object.defineProperty(this,w,{writable:!0,value:void 0}),Object(p.a)(this,x)[x]=Object(p.a)(this,w)[w]=O(t),Object(p.a)(this,y)[y]=n}return Object(v.a)(e,[{key:"get",value:function(){return Object(p.a)(this,w)[w].value}},{key:"push",value:function(e){var t=O(e,Object(p.a)(this,w)[w]);for(Object(p.a)(this,w)[w].next=t,Object(p.a)(this,w)[w]=t,Object(p.a)(this,E)[E]++;Object(p.a)(this,E)[E]>Object(p.a)(this,y)[y]&&Object(p.a)(this,x)[x].next;)Object(p.a)(this,w)[w]===Object(p.a)(this,x)[x]&&Object(p.a)(this,w)[w].next&&(Object(p.a)(this,w)[w]=Object(p.a)(this,w)[w].next,Object(p.a)(this,w)[w].prev=null),Object(p.a)(this,x)[x]=Object(p.a)(this,x)[x].next,Object(p.a)(this,x)[x].prev=null,Object(p.a)(this,E)[E]--;return this}},{key:"goBack",value:function(){return null!=Object(p.a)(this,w)[w].prev&&(Object(p.a)(this,w)[w]=Object(p.a)(this,w)[w].prev,Object(p.a)(this,E)[E]--),this}},{key:"goForward",value:function(){return null!=Object(p.a)(this,w)[w].next&&(Object(p.a)(this,w)[w]=Object(p.a)(this,w)[w].next,Object(p.a)(this,E)[E]++),this}},{key:"hasPrev",value:function(){return null!=Object(p.a)(this,w)[w].prev}},{key:"hasNext",value:function(){return null!=Object(p.a)(this,w)[w].next}}],[{key:"of",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return new e(t,n)}}]),e}(),P=null!=r?r:r=d().reduce((function(e,t){return e[t.name]=t,e}),{}),M=Object.keys(P),k={drawElements:[],draftElement:null,selectedElement:null,hoveredElement:null,activeTool:M[0],scrollPoint:[0,0]};function D(e){return{type:"updateScrollPoint",scrollPointShift:e}}function L(e){return{type:"setDrawElements",drawElements:e}}function B(e,t){switch(t.type){case"createDraftElement":return Object(l.a)(Object(l.a)({},e),{},{draftElement:t.element,selectedElement:null});case"selectElement":return Object(l.a)(Object(l.a)({},e),{},{selectedElement:t.drawElement});case"updateDraftElement":return e.draftElement?Object(l.a)(Object(l.a)({},e),{},{draftElement:Object(l.a)(Object(l.a)({},e.draftElement),{},{props:Object(l.a)(Object(l.a)({},e.draftElement.props),t.props)})}):e;case"saveDraftElement":return e.draftElement?Object(l.a)(Object(l.a)({},e),{},{drawElements:e.drawElements.concat(e.draftElement),selectedElement:e.draftElement,draftElement:null}):e;case"setActiveTool":return Object(l.a)(Object(l.a)({},e),{},{activeTool:t.tool});case"setDrawElements":return Object(l.a)(Object(l.a)({},e),{},{drawElements:t.drawElements});case"updateScrollPoint":return Object(l.a)(Object(l.a)({},e),{},{scrollPoint:[e.scrollPoint[0]+t.scrollPointShift[0],e.scrollPoint[1]+t.scrollPointShift[1]]});case"setHoveredElement":return Object(l.a)(Object(l.a)({},e),{},{hoveredElement:t.drawElement});case"dragHoveredDrawElement":return Object(l.a)(Object(l.a)({},e),{},{drawElements:e.drawElements.map((function(e){return e}))})}}var C="crosshair";var N=function(){var e=Object(a.useRef)(null),t=Object(a.useReducer)(B,k),n=Object(u.a)(t,2),r=n[0],c=n[1],o=function(e){var t=Object(a.useState)((function(){return g.of(e)})),n=Object(u.a)(t,1)[0],r=Object(a.useState)(n.hasNext()),c=Object(u.a)(r,2),o=c[0],i=c[1],l=Object(a.useState)(n.hasPrev()),s=Object(u.a)(l,2),d=s[0],f=s[1];return Object(a.useEffect)((function(){n.get()!==e&&(n.push(e),f(n.hasPrev()),i(n.hasNext()))}),[n,e]),{hasPrev:d,hasNext:o,goBack:function(){return n.goBack(),f(n.hasPrev()),i(n.hasNext()),n.get()},goForward:function(){return n.goForward(),f(n.hasPrev()),i(n.hasNext()),n.get()}}}(r.drawElements);!function(e,t){var n=Object(a.useRef)(e);n.current=e,Object(a.useEffect)((function(){function e(){var e=t.current;if(e){var r=window.devicePixelRatio||1;e.width=window.innerWidth*r,e.height=window.innerHeight*r,e.style.width=window.innerWidth+"px",e.style.height=window.innerHeight+"px";var a=e.getContext("2d");null!=a&&(a.scale(r,r),S(a,n.current.drawElements,n.current.draftElement,n.current.selectedElement,n.current.scrollPoint))}}return window.addEventListener("resize",e),e(),function(){window.removeEventListener("resize",e)}}),[t])}(r,e);var i=Object(a.useRef)(r.draftElement);return i.current=r.draftElement,Object(a.useEffect)((function(){var t=P[r.activeTool],n=0,a=0;function o(o){if(o.target===e.current){if(o.preventDefault(),n=o.clientX,a=o.clientY,1===o.buttons){if(r.hoveredElement)return document.addEventListener("pointermove",s),void document.addEventListener("pointerup",d);c({type:"createDraftElement",element:{id:(f++,(Date.now()+f).toString(32)),type:r.activeTool,props:t.onCreate(o.clientX-r.scrollPoint[0],o.clientY-r.scrollPoint[1])}}),document.addEventListener("pointermove",h),document.addEventListener("pointerup",m)}4===o.buttons&&(e.current&&(e.current.style.cursor="grab"),document.addEventListener("pointermove",u),document.addEventListener("pointerup",l))}}function u(e){var t=e.clientX-n,r=e.clientY-a;c(D([t,r])),n=e.clientX,a=e.clientY}function l(){e.current&&(e.current.style.cursor=C),document.removeEventListener("pointermove",u),document.removeEventListener("pointerup",l)}function s(e){var t=e.clientX-n,r=e.clientY-a;c({type:"dragHoveredDrawElement",shift:[t,r]}),n=e.clientX,a=e.clientY}function d(){e.current&&(e.current.style.cursor=C),c({type:"selectElement",drawElement:r.hoveredElement}),document.removeEventListener("pointermove",s),document.removeEventListener("pointerup",d)}function h(e){null!=i.current&&(c({type:"updateDraftElement",props:t.onDrawing(e.clientX-n,e.clientY-a,i.current.props)}),n=e.clientX,a=e.clientY)}function m(){c({type:"saveDraftElement"}),document.removeEventListener("pointermove",h),document.removeEventListener("pointerup",m)}function b(e){c(D([-e.deltaX,-e.deltaY]))}return document.addEventListener("wheel",b),document.addEventListener("pointerdown",o),function(){document.removeEventListener("pointerdown",o),document.removeEventListener("wheel",b)}}),[r.activeTool,r.hoveredElement,r.scrollPoint]),Object(a.useEffect)((function(){var t,n=null===(t=e.current)||void 0===t?void 0:t.getContext("2d");null!=n&&S(n,r.drawElements,r.draftElement,r.selectedElement,r.scrollPoint)}),[r.drawElements,r.draftElement,r.scrollPoint,r.selectedElement]),Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)(m,{className:"App__toolbar",children:M.map((function(e){return Object(h.jsx)("button",{disabled:r.activeTool===e,onClick:function(){return c({type:"setActiveTool",tool:e})},children:e},e)}))}),Object(h.jsxs)(m,{className:"App__toolbar",children:[Object(h.jsx)("button",{disabled:!o.hasPrev,onClick:function(){if(o.hasPrev){var e=o.goBack();c(L(e))}},children:"\u2190"}),Object(h.jsx)("button",{disabled:!o.hasNext,onClick:function(){if(o.hasNext){var e=o.goForward();c(L(e))}},children:"\u2192"})]}),Object(h.jsx)("canvas",{className:"App__canvas",ref:e,onMouseMove:function(t){if(t.target===e.current){var n=function(e,t){for(var n=null,r=e.length-1;r>=0;r--){var a=e[r];if(P[a.type].containsPoint(a.props,t)){n=a;break}}return n}(r.drawElements,[t.clientX-r.scrollPoint[0],t.clientY-r.scrollPoint[1]]);e.current.style.cursor=n?"move":C,c({type:"setHoveredElement",drawElement:n})}}})]})};function S(e,t,n,r,a){var c=Object(u.a)(a,2),o=c[0],i=c[1];e.clearRect(0,0,e.canvas.width,e.canvas.height),e.translate(o,i),t.forEach((function(t){P[t.type].draw(t.props,e)})),n&&P[n.type].draw(n.props,e),r&&function(e,t){t.save();var n=P[e.type].getBoundingBox(e.props);t.lineWidth=1,t.strokeStyle="blue",t.setLineDash(T),t.strokeRect(n.x-6,n.y-6,n.width+12,n.height+12),t.restore()}(r,e),e.translate(-o,-i)}var T=[5,5];var _=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,28)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))};i.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(N,{})}),document.getElementById("root")),_()},function(e,t,n){"use strict";n.r(t),n.d(t,"config",(function(){return u}));var r=n(5),a=n(2),c=n(6),o=n(12);function i(e,t,n){var c=function(e){if(!e.length)return"";var t=e.reduce((function(e,t,n,r){var c=Object(a.a)(t,2),o=c[0],i=c[1],u=Object(a.a)(r[(n+1)%r.length],2),l=u[0],s=u[1];return e.push(o,i,(o+l)/2,(i+s)/2),e}),["M"].concat(Object(r.a)(e[0]),["Q"]));return t.push("Z"),t.join(" ")}(Object(o.a)(e));n.fillStyle=t,n.fill(new Path2D(c))}var u=Object(c.a)({name:"Draw",draw:function(e,t){0!==e.points.length&&i(e.points,e.color,t)},onCreate:function(e,t){return{color:"black",points:[[e,t]]}},onDrawing:function(e,t,n){var c=Object(a.a)(n.points[n.points.length-1],2),o=c[0],i=c[1];return{points:[].concat(Object(r.a)(n.points),[[o+e,i+t]])}},getBoundingBox:function(e){var t=Math.min.apply(Math,Object(r.a)(e.points.map((function(e){return e[0]})))),n=Math.min.apply(Math,Object(r.a)(e.points.map((function(e){return e[1]}))));return{x:t,y:n,width:Math.max.apply(Math,Object(r.a)(e.points.map((function(e){return e[0]}))))-t,height:Math.max.apply(Math,Object(r.a)(e.points.map((function(e){return e[1]}))))-n}},containsPoint:function(e,t){var n=Object(a.a)(t,2),c=n[0],o=n[1],i=Math.min.apply(Math,Object(r.a)(e.points.map((function(e){return e[0]})))),u=Math.min.apply(Math,Object(r.a)(e.points.map((function(e){return e[1]})))),l=Math.max.apply(Math,Object(r.a)(e.points.map((function(e){return e[0]})))),s=Math.max.apply(Math,Object(r.a)(e.points.map((function(e){return e[1]}))));return Math.min(i,l)<=c&&Math.max(i,l)>=c&&Math.min(u,s)<=o&&Math.max(u,s)>=o}})}],[[26,1,2]]]);
//# sourceMappingURL=main.c7310a7e.chunk.js.map